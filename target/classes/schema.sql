DROP TABLE IF EXISTS PRESENCAS;
DROP TABLE IF EXISTS PAGAMENTOS;
DROP TABLE IF EXISTS NOTAS_FISCAIS;
DROP TABLE IF EXISTS MOVIMENTACOES_FINANCEIRAS;
DROP TABLE IF EXISTS MATRICULAS;
DROP TABLE IF EXISTS ITENS_MATRICULA;
DROP TABLE IF EXISTS PLANOS;
DROP TABLE IF EXISTS ALUNOS;

CREATE TABLE ALUNOS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(255),
    EMAIL VARCHAR(255),
    TELEFONE VARCHAR(255),
    DATA_NASCIMENTO DATE,
    ATIVO BOOLEAN
);

CREATE TABLE PLANOS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(255),
    DESCRICAO VARCHAR(255),
    DURACAO_MESES INT,
    VALOR DOUBLE
);

CREATE TABLE MATRICULAS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    DATA_INICIO DATE,
    DATA_FIM DATE,
    ATIVA BOOLEAN,
    ALUNO_ID BIGINT,
    PLANO_ID BIGINT,
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ID),
    FOREIGN KEY (PLANO_ID) REFERENCES PLANOS(ID)
);

CREATE TABLE NOTAS_FISCAIS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    DATA_EMISSAO DATE,
    VALOR_TOTAL DOUBLE,
    ALUNO_ID BIGINT NOT NULL,
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ID)
);

CREATE TABLE ITENS_MATRICULA (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(255),
    QUANTIDADE INT,
    VALOR_UNITARIO DOUBLE,
    VALOR_TOTAL DOUBLE,
    NOTA_FISCAL_ID BIGINT,
    FOREIGN KEY (NOTA_FISCAL_ID) REFERENCES NOTAS_FISCAIS(ID)
);

CREATE TABLE MOVIMENTACOES_FINANCEIRAS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    DATA_MOVIMENTACAO DATE,
    VALOR DOUBLE,
    TIPO VARCHAR(50),
    DESCRICAO VARCHAR(255),
    ALUNO_ID BIGINT,
    NOTA_FISCAL_ID BIGINT,
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ID),
    FOREIGN KEY (NOTA_FISCAL_ID) REFERENCES NOTAS_FISCAIS(ID)
);

CREATE TABLE PAGAMENTOS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    DATA_PAGAMENTO DATE,
    METODO VARCHAR(50),
    REFERENCIA VARCHAR(255),
    VALOR DOUBLE,
    ALUNO_ID BIGINT,
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ID)
);

CREATE TABLE PRESENCAS (
    ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    ENTRADA TIMESTAMP,
    SAIDA TIMESTAMP,
    OBSERVACAO VARCHAR(255),
    ALUNO_ID BIGINT,
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNOS(ID)
);
